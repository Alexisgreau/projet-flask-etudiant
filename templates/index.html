<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liste des étudiants</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100">
    <div class="container mx-auto mt-10">
        <h1 class="text-4xl font-bold text-center mb-8">Liste des étudiants</h1>

        <!-- Champ de recherche -->
        <div class="mb-6">
            <input type="text" id="search-bar" onkeyup="searchStudents()" placeholder="Rechercher un étudiant par nom, âge ou identifiant" 
                   class="w-full border border-gray-300 p-2 rounded" />
        </div>

        <!-- Affichage des étudiants avec boutons Détails et Supprimer -->
        <ul id="student-list" class="list-disc">
            {% for etudiant in etudiants %}
            <li class="mb-4 student-item" data-name="{{ etudiant.nom }}" data-age="{{ etudiant.age }}" data-id="{{ etudiant.identifiant }}">
                <div class="flex justify-between items-center bg-white p-4 rounded shadow">
                    <span>{{ etudiant.nom }} ({{ etudiant.age }} ans) - ID : {{ etudiant.identifiant }}</span>
                    <div>
                        <!-- Bouton pour afficher les détails de l'étudiant -->
                        <a href="{{ url_for('afficher_etudiant', id=loop.index0) }}" class="text-blue-500 hover:underline">Détails</a> |
                        <!-- Bouton pour supprimer l'étudiant avec confirmation -->
                        <form action="{{ url_for('supprimer_etudiant', id=loop.index0) }}" method="get" style="display:inline;">
                            <button type="submit" class="text-red-500 hover:underline" onclick="return confirm('Êtes-vous sûr de vouloir supprimer cet étudiant ?')">Supprimer</button>
                        </form>
                    </div>
                </div>
            </li>
            {% endfor %}
        </ul>

        <!-- Pagination -->
        <div class="flex justify-center mt-8">
            {% if page > 1 %}
            <a href="{{ url_for('afficher_etudiants', page=page-1) }}" class="bg-blue-500 text-white px-4 py-2 rounded mr-2">Précédent</a>
            {% endif %}

            {% for p in range(1, total_pages + 1) %}
            <a href="{{ url_for('afficher_etudiants', page=p) }}" class="px-4 py-2 rounded mr-2 {{ 'bg-blue-500 text-white' if p == page else 'bg-gray-200 text-gray-700' }}">{{ p }}</a>
            {% endfor %}

            {% if page < total_pages %}
            <a href="{{ url_for('afficher_etudiants', page=page+1) }}" class="bg-blue-500 text-white px-4 py-2 rounded ml-2">Suivant</a>
            {% endif %}
        </div>

        <!-- Bouton pour ajouter un étudiant -->
        <div class="text-center mt-8">
            <a href="{{ url_for('ajouter_etudiant') }}" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">Ajouter un étudiant</a>
        </div>
    </div>

    <script>
        // Fonction de recherche en temps réel
        function searchStudents() {
            const searchInput = document.getElementById("search-bar").value.toLowerCase();
            const studentItems = document.querySelectorAll(".student-item");

            studentItems.forEach(item => {
                const name = item.getAttribute("data-name").toLowerCase();
                const age = item.getAttribute("data-age");
                const id = item.getAttribute("data-id").toLowerCase();

                // Affiche ou masque l'élément en fonction de la recherche
                if (name.includes(searchInput) || age.includes(searchInput) || id.includes(searchInput)) {
                    item.style.display = "list-item";
                } else {
                    item.style.display = "none";
                }
            });
        }
    </script>
</body>
</html>
